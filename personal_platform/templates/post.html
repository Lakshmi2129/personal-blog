{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Webpage Design</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/mdi/css/materialdesignicons.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script src="https://cdn.ckeditor.com/ckeditor5/41.0.0/super-build/ckeditor.js"></script>
    <script src="https://cdn.ckeditor.com/ckeditor5/42.0.0/classic/ckeditor.js"></script>


</head>


<body>

    <div class="main">
        <div class="navbar">
            <img class="mt-2 logo" src="../static/images/logo.png" alt="" height="90">


            <div class="menu">
                <ul>
                    <li><a href="/">HOME</a></li>
                    <li><a href="">POSTS</a></li>

                </ul>
            </div>


            <div class="search">
                <button class="srch" type="search" data-bs-toggle="modal" data-bs-target="#add_blog_post_modal" style="border-right: 1px solid #ff7200;">Add Post</button>
            </div>

        </div>

        <div class="d-flex mt-5" id="blogs_id">

        </div>


        <!-- Modal -->
        <div class="modal fade" id="add_blog_post_modal" tabindex="-1" aria-labelledby="add_blog_post_modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Blog title</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="post_form">

                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Title</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="title" id="title" autocomplete="off" required />
                                </div>
                            </div>

                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Content</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="content" id="content" autocomplete="off" required />
                                </div>
                            </div>

                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Image</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="image" id="image" autocomplete=" off " required />
                                </div>
                            </div>


                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Summary</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="summary" id="summary" autocomplete="off" required />
                                </div>
                            </div>

                    </div>

                    <div class="modal-footer ">
                        <button type="button " class="btn " data-bs-dismiss="modal ">Close</button>
                        <button type="submit " class="btn ">POST</button>
                    </div>
                    </form>
                </div>
            </div>
        </div>


        <!-- Modal -->
        <div class="modal fade" id="edit_blog_post_modal" tabindex="-1" aria-labelledby="edit_blog_post_modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Edit Blog</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="edit_post_form">

                            <input type="hidden" class="edit_pk form-control" name="pk" />

                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Title</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="edit_title" id="edit_title" autocomplete="off" required />
                                </div>
                            </div>

                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Content</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="edit_content" id="edit_content" autocomplete="off" required />
                                </div>
                            </div>

                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Image</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="edit_image" id="edit_image" autocomplete=" off " required />
                                </div>
                            </div>


                            <div class="form-group row py-2">
                                <label class="col-sm-3 col-form-label">
                                    Summary</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="edit_summary" id="edit_summary" autocomplete="off" required />
                                </div>
                            </div>

                    </div>

                    <div class="modal-footer ">
                        <button type="button " class="btn " data-bs-dismiss="modal ">Close</button>
                        <button type="submit " onclick="submitForm()" class="btn ">POST</button>
                    </div>
                    </form>
                </div>
            </div>
        </div>

    </div>



    <!-- <script src="https://unpkg.com/ionicons@5.4.0/dist/ionicons.js "></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js " integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM " crossorigin="anonymous ">
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js " integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p " crossorigin="anonymous ">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js " integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF " crossorigin="anonymous ">
    </script>

    <script type="application/javascript " src="{% static 'js/vendors/sweetalert2@10.js' %} "></script>
    <script type="application/javascript " src="{% static 'js/common_function.js'%} "></script>
    <script type="application/javascript " src="{% static 'js/post.js'%} ">
    </script>


    <script>
        CKEDITOR.replace('#summary');

        function submitForm() {
            var formData = new FormData(document.getElementById('post_form'));
            var contentValue = CKEDITOR.instances.id_content.getData();
            formData.append('summary', contentValue);

            fetch('add_post_blogs', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}',
                    },
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    if (data.success) {
                        alert('Form submitted successfully');
                        window.location.reload(true);
                    } else {
                        alert('Form submission failed. Please check the errors.');
                    }
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        }
    </script>

</body>


</html>